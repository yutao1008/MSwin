# Self-attention on Multi-shifted Windows for Scene Segmentation

## Introduction

This is the PyTorch implementation of our [Self-attention on Multi-shifted Windows for Scene Segmentation] by Litao Yu, Zhibin Li and Jian Zhang

## Use of code

This implementation is built based on mmsegmentation (https://mmsegmentation.readthedocs.io/). Please follow their instructions to install the necessary modules for running the programs.

## Results and models

### Pascal VOC 2012 + Aug

| Method  | Backbone | Crop Size | Lr schd | mIoU | mIoU(ms+flip) | config                                                                                                                     | download                                                                                                                                                                                                                                                                                                                                               |
| ------- | -------- | --------- | ------: | ----: | ------------: | -------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| MSwin-P | Swin-S    | 512x512   |   80000 | 81.58 |         82.95 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1l4sP_sb3u8BcFoTjWz2O7yNBkPrqmV4L/view?usp=sharing) |
| MSwin-S | Swin-S    | 512x512   |   80000 | 81.97 |         82.74 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1izugSDALfH6cLbxIxDhA_4qspgjvVnso/view?usp=sharing)  |
| MSwin-C | Swin-S    | 512x512   |   80000 | 81.40 |         82.70 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1U66SYLKqE9SZ1eTDDUCY_g8DzqpaS8PE/view?usp=sharing)  |
| MSwin-P | Swin-B    | 512x512   |   80000 | 82.85 |         83.82 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_base_patch4_512x512_80k_voc2012_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1HEIZY6Gafelpw-Xv8Fe1g-3QFkF8bjTn/view?usp=sharing) |
| MSwin-S | Swin-B    | 512x512   |   80000 | 82.86 |         84.27 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_base_patch4_512x512_80k_voc2012_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1cRi9TAXV1lWX3CzFRGfPcbuzbtSOS0tU/view?usp=sharing)  |
| MSwin-C | Swin-B    | 512x512   |   80000 | 83.50 |         84.47 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_base_patch4_512x512_80k_voc2012_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1aeYlo6PD-yavZSH8119mT01lhFryeDG2/view?usp=sharing)  |

### Pascal COCOStuff-10K

| Method  | Backbone | Crop Size | Lr schd | mIoU | mIoU(ms+flip) | config                                                                                                                     | download                                                                                                                                                                                                                                                                                                                                               |
| ------- | -------- | --------- | ------: | ----: | ------------: | -------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| MSwin-P | Swin-S    | 480x480   |   40000 | 39.8 |         41.1 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_small_patch4_480x480_40k_cocostuff_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1f66ZUiw-vUQEhO4U_Zk6oRQcPl7yBAfP/view?usp=sharing)  |
| MSwin-S | Swin-S    | 480x480   |   40000 | 40.2 |         42.1 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_small_patch4_480x480_40k_cocostuff_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1PXuK9g8BPS0Ia65mkPWugxuTWSU1HJvc/view?usp=sharing)  |
| MSwin-C | Swin-S    | 480x480   |   40000 | 39.6 |         41.6 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_small_patch4_480x480_40k_cocostuff_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1xtpcDQpmu1mEc0nQ_uz2A3VHtr7t0DUS/view?usp=sharing)  |
| MSwin-P | Swin-B    | 480x480   |   40000 | 41.3 |         42.7 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_base_patch4_480x480_40k_cocostuff_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/19E4jurx4gbt3Q1WUEYUcDv45t28DabXe/view?usp=sharing) |
| MSwin-S | Swin-B    | 480x480   |   40000 | 41.1 |         42.4 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_base_patch4_480x480_40k_cocostuff_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1zbhdPOUVvEX7tgmN_zL61Et9XhBAz4dy/view?usp=sharing)  |
| MSwin-C | Swin-B    | 480x480   |   40000 | 41.0 |         42.8 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_base_patch4_480x480_40k_cocostuff_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1iAcQaa7pVvVYe-F2MpAx5BH2Xaqpebsj/view?usp=sharing)  |

### ADE20K

| Method  | Backbone | Crop Size | Lr schd | mIoU | mIoU(ms+flip) | config                                                                                                                     | download                                                                                                                                                                                                                                                                                                                                               |
| ------- | -------- | --------- | ------: | ----: | ------------: | -------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| MSwin-P | Swin-S    | 512x512   |   160000 | 47.11 |         48.55 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_small_patch4_512x512_160k_ade20k_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1XfTH8vmvbvQPH0WKh_mCC00vKg-AtTXv/view?usp=sharing) |
| MSwin-S | Swin-S    | 512x512   |   160000 | 47.52 |         48.56 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_small_patch4_512x512_160k_ade20k_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1JB8Ij2HIdmZmlR3PXn2NebeBZP6NTM_L/view?usp=sharing)  |
| MSwin-C | Swin-S    | 512x512   |   160000 | 46.26 |         48.12 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_small_patch4_512x512_160k_ade20k_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1i93XGSy7a-l5qSyJoiXPP1_hVEcCUXjJ/view?usp=sharing)  |
| MSwin-P | Swin-B    | 512x512   |   160000 | 48.38 |         50.29 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_base_patch4_512x512_160k_ade20k_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1zGn3vuToYeeohH34ZbhBlskpW1xcvwRA/view?usp=sharing) |
| MSwin-S | Swin-B    | 512x512   |   160000 | 48.54 |         50.26 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_base_patch4_512x512_160k_ade20k_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1cSv4xNO5FbK8ol0cnFwaMLC-nzysv7ow/view?usp=sharing)  |
| MSwin-C | Swin-B    | 512x512   |   160000 | 48.70 |         50.13 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_base_patch4_512x512_160k_ade20k_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1fqJjrV2SCxZzc9Ve1JbA47tFcbfkJFdJ/view?usp=sharing)  |


### Cityscapes

| Method  | Backbone | Crop Size | Lr schd | mIoU | mIoU(ms+flip) | config                                                                                                                     | download                                                                                                                                                                                                                                                                                                                                               |
| ------- | -------- | --------- | ------: | ----: | ------------: | -------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| MSwin-P | Swin-B    | 512x1024  |   80000 | 81.06 |         82.10 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_base_patch4_512x1024_80k_cityscapes_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1WFFLoMIKEhU4IjZv42MXQL81DqygyK87/view?usp=sharing) |
| MSwin-S | Swin-B    | 512x1024  |   80000 | 80.87 |         82.39 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_base_patch4_512x1024_80k_cityscapes_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/15XzoKOKK_FQYGMlRKt2DPhsvI45cBwIi/view?usp=sharing)  |
| MSwin-C | Swin-B    | 512x1024  |   80000 | 80.78 |         82.04 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_base_patch4_512x1024_80k_cityscapes_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1s080vg7K94CcTk-qScSRhDh1IfTrmvYa/view?usp=sharing)  |
