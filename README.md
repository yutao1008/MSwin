# Self-attention on Multi-shifted Windows for Scene Segmentation

## Introduction

This is the PyTorch implementation of our [Self-attention on Multi-shifted Windows for Scene Segmentation] by Litao Yu, Zhibin Li and Jian Zhang

## Use of code

This implementation is built based on mmsegmentation (https://mmsegmentation.readthedocs.io/). Please follow their instructions to install the necessary modules for running the programs.

## Results and models

### Pascal VOC 2012 + Aug

| Method  | Backbone | Crop Size | Lr schd | mIoU | mIoU(ms+flip) | config                                                                                                                     | download                                                                                                                                                                                                                                                                                                                                               |
| ------- | -------- | --------- | ------: | ----: | ------------: | -------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| MSwin-P | Swin-S    | 512x512   |   80000 | 77.10 |         78.37 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1l4sP_sb3u8BcFoTjWz2O7yNBkPrqmV4L/view?usp=sharing) |
| MSwin-S | Swin-S    | 512x512   |   80000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1izugSDALfH6cLbxIxDhA_4qspgjvVnso/view?usp=sharing)  |
| MSwin-C | Swin-S    | 512x512   |   80000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1U66SYLKqE9SZ1eTDDUCY_g8DzqpaS8PE/view?usp=sharing)  |
| MSwin-P | Swin-B    | 512x512   |   80000 | 77.10 |         78.37 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_base_patch4_512x512_80k_voc2012_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1HEIZY6Gafelpw-Xv8Fe1g-3QFkF8bjTn/view?usp=sharing) |
| MSwin-S | Swin-B    | 512x512   |   80000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_base_patch4_512x512_80k_voc2012_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1cRi9TAXV1lWX3CzFRGfPcbuzbtSOS0tU/view?usp=sharing)  |
| MSwin-C | Swin-B    | 512x512   |   80000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_base_patch4_512x512_80k_voc2012_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1aeYlo6PD-yavZSH8119mT01lhFryeDG2/view?usp=sharing)  |

### Pascal COCOStuff-10K

| Method  | Backbone | Crop Size | Lr schd | mIoU | mIoU(ms+flip) | config                                                                                                                     | download                                                                                                                                                                                                                                                                                                                                               |
| ------- | -------- | --------- | ------: | ----: | ------------: | -------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| MSwin-P | Swin-S    | 480x480   |   40000 | 77.10 |         78.37 | [config](https://drive.google.com/file/d/1f66ZUiw-vUQEhO4U_Zk6oRQcPl7yBAfP/view?usp=sharing) |
| MSwin-S | Swin-S    | 480x480   |   40000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/.py)  | [model](https://drive.google.com/file/d/1izugSDALfH6cLbxIxDhA_4qspgjvVnso/view?usp=sharing)  |
| MSwin-C | Swin-S    | 480x480   |   40000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/.py)  | [model](https://drive.google.com/file/d/1U66SYLKqE9SZ1eTDDUCY_g8DzqpaS8PE/view?usp=sharing)  |
| MSwin-P | Swin-B    | 480x480   |   40000 | 77.10 |         78.37 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/.py)  | [model](https://drive.google.com/file/d/1HEIZY6Gafelpw-Xv8Fe1g-3QFkF8bjTn/view?usp=sharing) |
| MSwin-S | Swin-B    | 480x480   |   40000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/.py)  | [model](https://drive.google.com/file/d/1cRi9TAXV1lWX3CzFRGfPcbuzbtSOS0tU/view?usp=sharing)  |
| MSwin-C | Swin-B    | 480x480   |   40000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/.py)  | [model](https://drive.google.com/file/d/1aeYlo6PD-yavZSH8119mT01lhFryeDG2/view?usp=sharing)  |

### ADE20K

| Method  | Backbone | Crop Size | Lr schd | mIoU | mIoU(ms+flip) | config                                                                                                                     | download                                                                                                                                                                                                                                                                                                                                               |
| ------- | -------- | --------- | ------: | ----: | ------------: | -------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| MSwin-P | Swin-S    | 512x512   |   80000 | 77.10 |         78.37 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1l4sP_sb3u8BcFoTjWz2O7yNBkPrqmV4L/view?usp=sharing) |
| MSwin-S | Swin-S    | 512x512   |   80000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1izugSDALfH6cLbxIxDhA_4qspgjvVnso/view?usp=sharing)  |
| MSwin-C | Swin-S    | 512x512   |   80000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1U66SYLKqE9SZ1eTDDUCY_g8DzqpaS8PE/view?usp=sharing)  |
| MSwin-P | Swin-B    | 512x512   |   80000 | 77.10 |         78.37 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_base_patch4_512x512_80k_voc2012_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1HEIZY6Gafelpw-Xv8Fe1g-3QFkF8bjTn/view?usp=sharing) |
| MSwin-S | Swin-B    | 512x512   |   80000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_base_patch4_512x512_80k_voc2012_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1cRi9TAXV1lWX3CzFRGfPcbuzbtSOS0tU/view?usp=sharing)  |
| MSwin-C | Swin-B    | 512x512   |   80000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_base_patch4_512x512_80k_voc2012_pretrain_384x384_22K.py)  | [model](https://drive.google.com/file/d/1aeYlo6PD-yavZSH8119mT01lhFryeDG2/view?usp=sharing)  |


### Cityscapes

| Method  | Backbone | Crop Size | Lr schd | mIoU | mIoU(ms+flip) | config                                                                                                                     | download                                                                                                                                                                                                                                                                                                                                               |
| ------- | -------- | --------- | ------: | ----: | ------------: | -------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| MSwin-P | Swin-B    | 512x1024  |   80000 | 77.10 |         78.37 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_par_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1l4sP_sb3u8BcFoTjWz2O7yNBkPrqmV4L/view?usp=sharing) |
| MSwin-S | Swin-B    | 512x1024  |   80000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_seq_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1izugSDALfH6cLbxIxDhA_4qspgjvVnso/view?usp=sharing)  |
| MSwin-C | Swin-B    | 512x1024  |   80000 | 80.10 |         81.49 | [config](https://github.com/yutao1008/MSwin/blob/main/configs/mswin/mswin_crs_small_patch4_512x512_80k_voc2012_pretrain_224x224_1K.py)  | [model](https://drive.google.com/file/d/1U66SYLKqE9SZ1eTDDUCY_g8DzqpaS8PE/view?usp=sharing)  |
